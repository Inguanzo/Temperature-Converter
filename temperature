var THEME = require('themes/flat/theme');
var SLIDERS = require('controls/sliders');
var tempVal = "";
var convertedVal = "";
var BUTTONS = require('controls/buttons');
var startMeasurementVal = "";
var endMeasurementVal = "";


//skins and styles
var whiteS = new Skin({fill:"white"});
var lightBlueS = new Skin({fill:"#89CFF0"});
var labelStyle = new Style( { font: "bold 40px", color:"#E52B50" } );

var labelFromStyle = new Style( { font: "bold 40px", color:"gray" } );
var labelToStyle = new Style( { font: "bold 40px", color:"#3B444B" } );

var smallLabelStyle = new Style( { font: "bold 20px", color:"#E52B50" } );

var bigText = new Style({font:"bold 20px", color:"#333333"});

//constant labels
var myFromLabel = new Label({left:0, right:250, height: 20, top: 10, string: "From:", style: smallLabelStyle})
var myToLabel = new Label({left:0, right:250, height: 20, bottom: 200, string: "To:", style: smallLabelStyle})


//slider info
var myLabel = new Label({left:0, right:0, height: 20, top: 60, string: "start", style: labelStyle})
var myConvertedLabel = new Label({left:0, right:0, height: 20, bottom: 60, string: "", style: labelStyle})

var mySlider = SLIDERS.HorizontalSlider.template(function($){ return{
	height:50, left:50, right:50,
	behavior: Object.create(SLIDERS.HorizontalSliderBehavior.prototype, {
		onValueChanged: { value: function(container){
			SLIDERS.HorizontalSliderBehavior.prototype.onValueChanged.call(this, container);
			tempVal = Math.round(this.data.value);
			myLabel.string = tempVal;
			fromOneToOther();		
	}}})
}});


function headerChange() {
	if(changeStart){
	
	};
};


//conversion Function
function convertFunction(measure) {
	convertedVal = tempVal;
	myConvertedLabel.string = measure;
};


///from Fahrenheit,Celsius,Kelvin to all
function fromOneToOther(){
			if (startMeasurementVal == "Fahrenheit") {
				if (endMeasurementVal == "Fahrenheit") {
					convertedVal = Math.round(tempVal);
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Celsius") {
					convertedVal = Math.round((tempVal - 32)/1.8);
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Kelvin") {
					convertedVal = Math.round((((tempVal - 32) * 5)/9) + 273.15);
					convertFunction(convertedVal);
				}
			}		
			
			//from Celsius to all
			if (startMeasurementVal == "Celsius") {
				if (endMeasurementVal == "Fahrenheit") {
					convertedVal = Math.round((tempVal*1.8)+32);
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Celsius") {
					convertedVal = Math.round(tempVal);
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Kelvin") {
					convertedVal = Math.round(tempVal + 273.15);
					convertFunction(convertedVal);
				}
			}
			
			//from Kelvin to all
			if (startMeasurementVal == "Kelvin") {
				if (endMeasurementVal == "Fahrenheit") {
					convertedVal = Math.round(((tempVal - 273.15) * 1.8) + 32);
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Celsius") {
					convertedVal = Math.round(tempVal - 273.15);
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Kelvin") {
					convertedVal = Math.round(tempVal);
					convertFunction(convertedVal);
				}
			}
};


//measurement
var myStartMeasurement = BUTTONS.RadioGroup.template(function($){ return{
	top:100, left:50, right:50,
	behavior: Object.create(BUTTONS.RadioGroupBehavior.prototype, {
		onRadioButtonSelected: { value: function(buttonName){
			startMeasurementVal = buttonName;
	}}})
}});


var myEndMeasurement = BUTTONS.RadioGroup.template(function($){ return{
	bottom:100, left:50, right:50,
	behavior: Object.create(BUTTONS.RadioGroupBehavior.prototype, {
		onRadioButtonSelected: { value: function(buttonName){
			trace("end measurement:" + buttonName + " was selected.\n");
			endMeasurementVal = buttonName;
			if(tempVal != "" && startMeasurementVal !=  "" && endMeasurementVal != ""){
			fromOneToOther();
		}
	}}})
}});


// calls
var slider = new mySlider({ min:-50, max:115, value:33,  });
var startMeasurement = new myStartMeasurement({ buttonNames: "Fahrenheit,Celsius,Kelvin" });
var endMeasurement = new myEndMeasurement({ buttonNames: "Fahrenheit,Celsius,Kelvin" });


//main
var mainCon = new Container({left:0, right:0, top:0, bottom:0, skin: lightBlueS});
application.add(mainCon);
mainCon.add(myLabel);
mainCon.add(myFromLabel);
mainCon.add(myToLabel);
mainCon.add(myConvertedLabel);
mainCon.add(startMeasurement);
mainCon.add(endMeasurement);
mainCon.add(slider);
