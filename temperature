var THEME = require('themes/flat/theme');
var SLIDERS = require('controls/sliders');
var tempVal = 10;
var convertedVal = 1;
var BUTTONS = require('controls/buttons');
var startMeasurementVal = "none";
var endMeasurementVal = "none";

//skins and styles
var whiteS = new Skin({fill:"white"});
var greyS = new Skin({fill:"grey"});
var labelStyle = new Style( { font: "bold 40px", color:"white" } );

//slider info
var myLabel = new Label({left:0, right:0, height: 40, top: 100, string: "", style: labelStyle})
var myConvertedLabel = new Label({left:0, right:0, height: 40, bottom: 100, string: "", style: labelStyle})

var mySlider = SLIDERS.HorizontalSlider.template(function($){ return{
	height:50, left:50, right:50,
	behavior: Object.create(SLIDERS.HorizontalSliderBehavior.prototype, {
		onValueChanged: { value: function(container){
			SLIDERS.HorizontalSliderBehavior.prototype.onValueChanged.call(this, container);
			//tempVal.onValueChanged.call(mainCon, container);
			tempVal = this.data.value;
			trace("Value is: " + tempVal + "\n");
			mainCon.remove(myLabel);
			myLabel = new Label({left:0, right:0, height: 30, top: 40, string: tempVal, style: labelStyle})
			
			//from Fahrenheit to all
			if (startMeasurementVal == "Fahrenheit") {
				if (endMeasurementVal == "Fahrenheit") {
					convertedVal = tempVal;
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Celsius") {
					convertedVal = (tempVal - 32)/1.8;
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Kelvin") {
					convertedVal = (((tempVal - 32) * 5)/9) + 273.15
					convertFunction(convertedVal);
				}
			}		
			
			//from Celsius to all
			if (startMeasurementVal == "Celsius") {
				if (endMeasurementVal == "Fahrenheit") {
					convertedVal = (tempVal*1.8)+32;
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Celsius") {
					convertedVal = tempVal;
					convertFunction(convertedVal);
				}
				else if (endMeasurementVal == "Kelvin") {
					convertedVal = tempVal + 273.15
					convertFunction(convertedVal);
				}
			}
			
			//from Kelvin to all
			
			
			
			mainCon.add(myLabel);	
	}}})
}});

//conversion Function
function convertFunction(measure) {
	convertedVal = tempVal;
	mainCon.remove(myConvertedLabel);
	myConvertedLabel = new Label({left:0, right:0, height: 30, bottom: 40, string: measure, style: labelStyle})
	mainCon.add(myConvertedLabel);
};

//measurement
var myStartMeasurement = BUTTONS.RadioGroup.template(function($){ return{
	top:100, bottom:50, left:50, right:50,
	behavior: Object.create(BUTTONS.RadioGroupBehavior.prototype, {
		onRadioButtonSelected: { value: function(buttonName){
			startMeasurementVal = buttonName;
	}}})
}});

var myEndMeasurement = BUTTONS.RadioGroup.template(function($){ return{
	bottom:100, left:50, right:50,
	behavior: Object.create(BUTTONS.RadioGroupBehavior.prototype, {
		onRadioButtonSelected: { value: function(buttonName){
			trace("end measurement:" + buttonName + " was selected.\n");
			endMeasurementVal = buttonName;
			
	}}})
}});


//convert



// calls
var slider = new mySlider({ min:-50, max:115, value:33,  });
var startMeasurement = new myStartMeasurement({ buttonNames: "Fahrenheit,Celsius,Kelvin" });
var endMeasurement = new myEndMeasurement({ buttonNames: "Fahrenheit,Celsius,Kelvin" });


//main
var mainCon = new Container({left:0, right:0, top:0, bottom:0, skin: greyS});
application.add(mainCon);
mainCon.add(myLabel);
mainCon.add(myConvertedLabel);
mainCon.add(startMeasurement);
mainCon.add(endMeasurement);
mainCon.add(slider);
